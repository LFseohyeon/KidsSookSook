<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="fieldTrip">
	<select id="selectCategoryAll" parameterType="map" resultType="fieldTripDTO">
		select tft.category_id, category_name, field_trip_id, user_id, field_trip_registation_date, field_trip_deadline_date, field_trip_program_date, 
		field_trip_place, field_trip_price, field_trip_context_description 
		from tbl_category tc join tbl_field_trip tft 
		on tc.category_id = tft.category_id and tc.category_id = #{categoryId} 
		order by field_trip_id desc
		limit #{startRow}, #{rowCount}
	</select>
	
	<select id="getTotal" parameterType="long" resultType="long">
		select count(field_trip_id) from tbl_category tc join tbl_field_trip tft 
		on tc.category_id = tft.category_id and tc.category_id = #{categoryId}
	</select>
	
	<!-- <select id="selectCategoryReview" parameterType="long" resultType="fieldTripDTO">
		select tft.field_trip_id, field_trip_registation_date, field_trip_deadline_date, field_trip_program_date,
		field_trip_place, field_trip_price, field_trip_context_description, count(review_id)
		from tbl_field_trip tft join tbl_review tr
		on tft.field_trip_id = tr.field_trip_id and category_id = #{categoryId}
		group by tft.field_trip_id
		order by count(review_id) desc
	</select> -->
	
	<select id="fieldTripDetail" parameterType="long" resultType="com.app.fieldTrip.domain.FieldTripDetailDTO">
		select tft.field_trip_id, user_id, category_id, field_trip_name, 
		field_trip_registation_date, field_trip_deadline_date, field_trip_program_date, 
		field_trip_place, field_trip_price, field_trip_context_description,
		field_trip_detail_id, field_trip_detail_context, field_trip_detail_institution_info,
		field_trip_detail_use_time, field_trip_detail_refund_policy
		from tbl_field_trip tft join tbl_field_trip_detail tftd 
		on tft.field_trip_id = tftd.field_trip_id and tft.field_trip_id = #{fieldTripId}
	</select>
</mapper>